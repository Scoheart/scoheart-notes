# Module Bundler

## 什么是模块打包器

模块打包器，顾名思义就是进行模块代码打包、合并的工具。我们耳熟能详的打包器有这些：

- browserify
- webpack
- rollup
- parcel
- esbuild
- unbuild
- vite
- etc.

## 为什么需要模块打包器

刀耕火种的时代，JavaScript 代码直接写在 HTML 文件或单个 JavaScript 脚本文件中。然而，随着 web 应用的复杂性不断增加，少量的 JavaScript 代码和单一的脚本文件已经无法满足开发者的需求。而随着项目越来越大，JavaScript 代码越来越复杂，如何实现一种有效的组织、管理和优化前端代码的方式成为了难题。

而所谓时势造英雄，模块化开发和模块打包器应运而生。

## 什么是模块化编程

- https://en.wikipedia.org/wiki/Modular_programming

## 模块化与模块打包器带来了什么

1. 模块化开发：前端项目变得越来越庞大和复杂，传统的脚本加载方式容易导致命名冲突、代码混乱等问题。模块打包器允许开发者将代码分割成小的、独立的模块，使得代码更易于维护、测试和理解。每个模块可以专注于特定的功能，而不需要关心全局变量和依赖。

2. 依赖管理：在一个前端项目中，可能会有大量的第三方库和工具，它们之间存在依赖关系。模块打包器可以帮助管理这些依赖关系，确保它们正确加载和执行。通过模块打包器，开发者可以更容易地引入、升级和管理项目依赖。

3. 资源优化：模块打包器可以帮助优化前端资源的加载性能。它可以将多个小文件合并为一个或少数几个大文件，减少网络请求的数量，从而提高页面加载速度。同时，模块打包器还能对代码进行压缩、混淆，减小文件体积，提高前端应用的性能。

4. 支持前端工程化：前端开发越来越趋向于工程化，需要使用编译工具、自动化工具、测试工具等等。模块打包器通常与这些工具协同工作，为开发者提供更强大的工程化能力。例如，自动化构建、代码分割、按需加载等功能，都是通过模块打包器来实现的。

## 不止于 JavaScript 的模块化

那么从这个角度来看，我们的模块打包器只是用来解决了 JavaScript 模块化代码的集成打包问题。所以这样来说，模块打包器就只是负责 JavaScript 代码模块的集成打包工具。那么涉及的打包项为：

- 自己编写的 JavaScript 代码模块
- 第三方库的 JavaScript 代码模块

然而，实际上随着 web 应用的复杂性不断增加，我们的样式代码、图片资源、HTML 模板等静态资源也逐渐模块化，正如 webpack 的核心理念 —— 万物皆模块。所以他们也需要打包合并。因此，模块打包器功能的演进也远远不止于 JavaScript 模块化代码的打包。故现代化的模块打包项为：

- 自己编写的 JavaScript 代码模块
- 第三方库的 JavaScript 代码模块
- 图片资源
- 样式资源
- 模板资源
- 等等

## 如何编写 JavaScript 模块化代码

非常可惜，JavaScript 诞生之初，并没有模块化代码的概念。但是随着项目越来越复杂，JavaScript 模块化迫在眉睫，于是社区的开发者们开始尝试编写 JavaScript 模块化代码。众多的模块化代码方案横空出世，如：

- CommonJS 规范（实现：Nodejs 运行时）
- AMD 规范（实现：RequireJS 代码库）
- CMD 规范（实现：SeaJS 代码库）
- UMD 规范（其出现是为了兼容 Commonjs 和 AMD，因此严格来说，并不是一个规范。其实现方法是 IIFE 立即执行函数）

但同时，随着 ECMAScript 2015（ES6）的发布，我们的 JavaScript 也终于迎来了原生的模块系统

- ESM

## 模块化方案的演进

见本文：[模块化方案的演进](https://juejin.cn/post/7334503381199847475)

## 如何使用模块打包器 (How)

### browserify

```js
// sum.js
```

### rollup

rollup 是一个 ES Module 模块的打包器，可以将 ES Module 打包为 CommonJS 或者 AMD 模块等。

- 默认只能打包 ES Module
- 默认只支持自己编写的 js 模块化代码
- 默认不支持图片等静态资源（不确定）

三种解决方案

- 如果不仅需要打包 ES Module，还需要打包 CommonJS 或者 AMD 模块，可以使用 @rollup/plugin-commonjs
- 如果需要打包第三方库的 js 模块化代码，可以使用 @rollup/plugin-node-resolve
- 图片等静态资源，可以使用 @rollup

### webpack
